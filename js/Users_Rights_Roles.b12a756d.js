"use strict";(self["webpackChunkvue_shop"]=self["webpackChunkvue_shop"]||[]).push([[223],{5041:function(e,t,o){o.r(t),o.d(t,{default:function(){return p}});var a=o(311);const l=(0,a.createTextVNode)("首页"),r=(0,a.createTextVNode)("权限管理"),i=(0,a.createTextVNode)("权限列表"),s=(0,a.createTextVNode)("一级权限"),d=(0,a.createTextVNode)("二级权限"),n=(0,a.createTextVNode)("三级权限");function c(e,t,o,c,u,m){const h=(0,a.resolveComponent)("el-breadcrumb-item"),p=(0,a.resolveComponent)("el-breadcrumb"),g=(0,a.resolveComponent)("el-table-column"),V=(0,a.resolveComponent)("el-tag"),f=(0,a.resolveComponent)("el-table"),C=(0,a.resolveComponent)("el-card");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createVNode)(p,{"separator-class":"el-icon-arrow-right"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(h,{to:{path:"/home"}},{default:(0,a.withCtx)((()=>[l])),_:1}),(0,a.createVNode)(h,null,{default:(0,a.withCtx)((()=>[r])),_:1}),(0,a.createVNode)(h,null,{default:(0,a.withCtx)((()=>[i])),_:1})])),_:1}),(0,a.createVNode)(C,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(f,{data:u.rightsList,border:"",stripe:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(g,{type:"index",label:"索引"}),(0,a.createVNode)(g,{label:" 权限名称",prop:"authName"}),(0,a.createVNode)(g,{label:" 路径",prop:"path"}),(0,a.createVNode)(g,{label:" 权限等级",prop:"level"},{default:(0,a.withCtx)((e=>["0"===e.row.level?((0,a.openBlock)(),(0,a.createBlock)(V,{key:0},{default:(0,a.withCtx)((()=>[s])),_:1})):(0,a.createCommentVNode)("",!0),"1"===e.row.level?((0,a.openBlock)(),(0,a.createBlock)(V,{key:1,type:"success"},{default:(0,a.withCtx)((()=>[d])),_:1})):(0,a.createCommentVNode)("",!0),"2"===e.row.level?((0,a.openBlock)(),(0,a.createBlock)(V,{key:2,type:"warning"},{default:(0,a.withCtx)((()=>[n])),_:1})):(0,a.createCommentVNode)("",!0)])),_:1})])),_:1},8,["data"])])),_:1})])}var u={data(){return{rightsList:[]}},created(){this.getRightsList()},methods:{async getRightsList(){const{data:e}=await this.$http.get("rights/list");if(200!==e.meta.status)return this.$message.error("获取权限列表失败");this.rightsList=e.data}}},m=o(89);const h=(0,m.Z)(u,[["render",c]]);var p=h},4343:function(e,t,o){o.r(t),o.d(t,{default:function(){return $}});var a=o(311);const l=e=>((0,a.pushScopeId)("data-v-70edc222"),e=e(),(0,a.popScopeId)(),e),r=(0,a.createTextVNode)("首页"),i=(0,a.createTextVNode)("权限管理"),s=(0,a.createTextVNode)("角色列表"),d=(0,a.createTextVNode)("添加角色"),n=l((()=>(0,a.createElementVNode)("i",{class:"el-icon-caret-right"},null,-1))),c=l((()=>(0,a.createElementVNode)("i",{class:"el-icon-caret-right"},null,-1))),u=(0,a.createTextVNode)("编辑"),m=(0,a.createTextVNode)("删除"),h=(0,a.createTextVNode)("分配权限"),p={class:"dialog-footer"},g=(0,a.createTextVNode)("取 消"),V=(0,a.createTextVNode)("确 定"),f={class:"dialog-footer"},C=(0,a.createTextVNode)("取 消"),w=(0,a.createTextVNode)("确 定"),N={class:"dialog-footer"},b=(0,a.createTextVNode)("取 消"),x=(0,a.createTextVNode)("确 定");function y(e,t,o,l,y,v){const _=(0,a.resolveComponent)("el-breadcrumb-item"),k=(0,a.resolveComponent)("el-breadcrumb"),R=(0,a.resolveComponent)("el-button"),D=(0,a.resolveComponent)("el-col"),F=(0,a.resolveComponent)("el-row"),$=(0,a.resolveComponent)("el-tag"),B=(0,a.resolveComponent)("el-table-column"),E=(0,a.resolveComponent)("el-table"),L=(0,a.resolveComponent)("el-card"),I=(0,a.resolveComponent)("el-input"),U=(0,a.resolveComponent)("el-form-item"),T=(0,a.resolveComponent)("el-form"),z=(0,a.resolveComponent)("el-dialog"),S=(0,a.resolveComponent)("el-tree");return(0,a.openBlock)(),(0,a.createElementBlock)("div",null,[(0,a.createVNode)(k,{"separator-class":"el-icon-arrow-right"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(_,{to:{path:"/home"}},{default:(0,a.withCtx)((()=>[r])),_:1}),(0,a.createVNode)(_,null,{default:(0,a.withCtx)((()=>[i])),_:1}),(0,a.createVNode)(_,null,{default:(0,a.withCtx)((()=>[s])),_:1})])),_:1}),(0,a.createVNode)(L,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(F,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(D,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(R,{type:"primary",onClick:t[0]||(t[0]=e=>y.addDialogVisible=!0)},{default:(0,a.withCtx)((()=>[d])),_:1})])),_:1})])),_:1}),(0,a.createVNode)(E,{data:y.rolelist,border:"",stripe:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(B,{type:"expand"},{default:(0,a.withCtx)((e=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.row.children,((t,o)=>((0,a.openBlock)(),(0,a.createBlock)(F,{class:(0,a.normalizeClass)(["bdbottom",0===o?"bdtop":"","vcenter"]),key:t.id},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(D,{span:5},{default:(0,a.withCtx)((()=>[(0,a.createVNode)($,{closable:"",onClose:o=>v.removeRightById(e.row,t.id)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.authName),1)])),_:2},1032,["onClose"]),n])),_:2},1024),(0,a.createVNode)(D,{span:19},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(t.children,((t,o)=>((0,a.openBlock)(),(0,a.createBlock)(F,{class:(0,a.normalizeClass)([0===o?"":"bdtop","vcenter"]),key:t.id},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(D,{span:6},{default:(0,a.withCtx)((()=>[(0,a.createVNode)($,{type:"success",closable:"",onClose:o=>v.removeRightById(e.row,t.id)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.authName),1)])),_:2},1032,["onClose"]),c])),_:2},1024),(0,a.createVNode)(D,{span:18},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(t.children,((t,o)=>((0,a.openBlock)(),(0,a.createBlock)($,{type:"warning",key:t.id,closable:"",onClose:o=>v.removeRightById(e.row,t.id)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.authName),1)])),_:2},1032,["onClose"])))),128))])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:1}),(0,a.createVNode)(B,{type:"index"}),(0,a.createVNode)(B,{label:"角色名称",prop:"roleName"}),(0,a.createVNode)(B,{label:"角色描述",prop:"roleDesc"}),(0,a.createVNode)(B,{label:"操作",width:"300px"},{default:(0,a.withCtx)((e=>[(0,a.createVNode)(R,{size:"mini",type:"primary",icon:y.Edit,onClick:t=>v.showEditDialog(e.row.id)},{default:(0,a.withCtx)((()=>[u])),_:2},1032,["icon","onClick"]),(0,a.createVNode)(R,{size:"mini",type:"danger",icon:y.Delete,onClick:t=>v.rolesdelete(e.row.id)},{default:(0,a.withCtx)((()=>[m])),_:2},1032,["icon","onClick"]),(0,a.createVNode)(R,{size:"mini",type:"warning",icon:y.Setting,onClick:t=>v.showSetRightDialog(e.row)},{default:(0,a.withCtx)((()=>[h])),_:2},1032,["icon","onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,a.createVNode)(z,{title:"添加角色",modelValue:y.addDialogVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>y.addDialogVisible=e),onClose:e.addDislogClosed},{footer:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",p,[(0,a.createVNode)(R,{onClick:t[3]||(t[3]=e=>y.addDialogVisible=!1)},{default:(0,a.withCtx)((()=>[g])),_:1}),(0,a.createVNode)(R,{type:"primary",onClick:v.addRolesUser},{default:(0,a.withCtx)((()=>[V])),_:1},8,["onClick"])])])),default:(0,a.withCtx)((()=>[(0,a.createVNode)(T,{model:y.addRolesForm,rules:e.addFormRules,ref:"addRolesForm","label-width":"100px"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{label:"角色名称",prop:"roleName"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(I,{modelValue:y.addRolesForm.roleName,"onUpdate:modelValue":t[1]||(t[1]=e=>y.addRolesForm.roleName=e)},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(U,{label:"角色描述",prop:"roleDesc"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(I,{modelValue:y.addRolesForm.roleDesc,"onUpdate:modelValue":t[2]||(t[2]=e=>y.addRolesForm.roleDesc=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","onClose"]),(0,a.createVNode)(z,{title:"修改角色",modelValue:y.editDialogVisible,"onUpdate:modelValue":t[8]||(t[8]=e=>y.editDialogVisible=e),width:"30%"},{footer:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",f,[(0,a.createVNode)(R,{onClick:t[7]||(t[7]=e=>y.editDialogVisible=!1)},{default:(0,a.withCtx)((()=>[C])),_:1}),(0,a.createVNode)(R,{type:"primary",onClick:v.editFormInfo},{default:(0,a.withCtx)((()=>[w])),_:1},8,["onClick"])])])),default:(0,a.withCtx)((()=>[(0,a.createVNode)(T,{model:y.editRolesForm,rules:e.editFormRules,ref:"editFormRef","label-width":"100px"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{label:"角色名称",prop:"roleName"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(I,{modelValue:y.editRolesForm.roleName,"onUpdate:modelValue":t[5]||(t[5]=e=>y.editRolesForm.roleName=e)},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(U,{label:"角色描述",prop:"roleDesc"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(I,{modelValue:y.editRolesForm.roleDesc,"onUpdate:modelValue":t[6]||(t[6]=e=>y.editRolesForm.roleDesc=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),(0,a.createVNode)(z,{title:"分配权限",modelValue:y.SetRightDialogVisible,"onUpdate:modelValue":t[10]||(t[10]=e=>y.SetRightDialogVisible=e),width:"50%",onClosed:v.SetRightDialogVisibleClosed},{footer:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",N,[(0,a.createVNode)(R,{onClick:t[9]||(t[9]=e=>y.SetRightDialogVisible=!1)},{default:(0,a.withCtx)((()=>[b])),_:1}),(0,a.createVNode)(R,{type:"primary",onClick:v.allotRights},{default:(0,a.withCtx)((()=>[x])),_:1},8,["onClick"])])])),default:(0,a.withCtx)((()=>[(0,a.createVNode)(S,{data:y.rightsList,props:y.treeProps,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":y.defKeys,ref:"treeRef"},null,8,["data","props","default-checked-keys"])])),_:1},8,["modelValue","onClosed"])])}var v=o(547),_=o(4876),k=o(5092),R={data(){return{rolelist:[],rightsList:[],addDialogVisible:!1,editDialogVisible:!1,SetRightDialogVisible:!1,addRolesForm:{roleName:"",roleDesc:""},editRolesForm:{},treeProps:{children:"children",label:"authName"},defKeys:[],rolesId:"",Delete:v.Z,Edit:_.Z,Setting:k.Z}},created(){this.getRolesList()},methods:{async getRolesList(){const{data:e}=await this.$http.get("roles");if(200!==e.meta.status)return this.$message.error("获取角色列表失败！");this.rolelist=e.data},addRolesUser(){this.$refs.addRolesForm.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post("roles",this.addRolesForm);if(201!==t.meta.status)return this.$message.error("添加角色失败!");this.$message.success("添加角色成功!"),this.getRolesList(),this.addDialogVisible=!1}))},async showEditDialog(e){const{data:t}=await this.$http.get("roles/"+e);if(200!==t.meta.status)return this.$message.error("查询角色失败!");this.editRolesForm=t.data,this.editDialogVisible=!0},editFormInfo(){this.$refs.editFormRef.validate((e=>{e&&(this.$http.put("roles/"+this.editRolesForm.roleId,{roleName:this.editRolesForm.roleName,roleDesc:this.editRolesForm.roleDesc}).then((e=>{if(200!==e.data.meta.status)return this.$message.error("修改角色失败!");this.$message.success("修改角色成功!"),this.getRolesList()})),this.editDialogVisible=!1)}))},async rolesdelete(e){const t=await this.$confirm("此操作将永久删除该角色, 是否继续?","删除角色",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==t)return this.$message.info("已取消该删除操作");this.$http.delete("roles/"+e).then((e=>{const{data:t}=e;if(200!==t.meta.status)return this.$message.error("该用户删除失败");this.$message.success("该用户已经删除"),this.getRolesList()}))},async showSetRightDialog(e){this.rolesId=e.id;const{data:t}=await this.$http.get("rights/tree");if(200!==t.meta.status)return this.$message.error("获取权限失败");this.rightsList=t.data,this.getLeafKeys(e,this.defKeys),this.SetRightDialogVisible=!0},getLeafKeys(e,t){if(!e.children)return t.push(e.id);e.children.forEach((e=>this.getLeafKeys(e,t)))},SetRightDialogVisibleClosed(){this.defKeys=[]},async allotRights(){const e=[...this.$refs.treeRef.getCheckedKeys(),...this.$refs.treeRef.getHalfCheckedKeys()],t=e.join(","),{data:o}=await this.$http.post(`roles/${this.rolesId}/rights`,{rids:t});if(200!==o.meta.status)return this.$message.error("分配权限失败!");this.$message.success("分配权限成功!"),this.getRolesList(),this.SetRightDialogVisible=!1},async removeRightById(e,t){const o=await this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==o)return this.$message.info("取消了删除!");const{data:a}=await this.$http.delete(`roles/${e.id}/rights/${t}`);if(200!==a.meta.status)return this.$message.error("删除权限失败!");e.children=a.data}}},D=o(89);const F=(0,D.Z)(R,[["render",y],["__scopeId","data-v-70edc222"]]);var $=F},1253:function(e,t,o){o.r(t),o.d(t,{default:function(){return D}});var a=o(311);const l=(0,a.createTextVNode)("首页"),r=(0,a.createTextVNode)("用户管理"),i=(0,a.createTextVNode)("用户列表"),s={class:"input-group mb-3"},d=(0,a.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-search",viewBox:"0 0 16 16"},[(0,a.createElementVNode)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})],-1),n=[d],c={class:"dialog-footer"},u=(0,a.createTextVNode)("取消"),m=(0,a.createTextVNode)("确定"),h={class:"dialog-footer"},p=(0,a.createTextVNode)("取消"),g=(0,a.createTextVNode)("确定"),V=(0,a.createTextVNode)("分配的新角色： "),f={class:"dialog-footer"},C=(0,a.createTextVNode)("取 消"),w=(0,a.createTextVNode)("确 定");function N(e,t,o,d,N,b){const x=(0,a.resolveComponent)("el-breadcrumb-item"),y=(0,a.resolveComponent)("el-breadcrumb"),v=(0,a.resolveComponent)("el-col"),_=(0,a.resolveComponent)("el-row"),k=(0,a.resolveComponent)("el-table-column"),R=(0,a.resolveComponent)("el-switch"),D=(0,a.resolveComponent)("el-button"),F=(0,a.resolveComponent)("el-tooltip"),$=(0,a.resolveComponent)("el-table"),B=(0,a.resolveComponent)("el-pagination"),E=(0,a.resolveComponent)("el-card"),L=(0,a.resolveComponent)("el-input"),I=(0,a.resolveComponent)("el-form-item"),U=(0,a.resolveComponent)("el-form"),T=(0,a.resolveComponent)("el-dialog"),z=(0,a.resolveComponent)("el-option"),S=(0,a.resolveComponent)("el-select");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createVNode)(y,{"separator-class":"el-icon-arrow-right"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(x,{to:{path:"/home"}},{default:(0,a.withCtx)((()=>[l])),_:1}),(0,a.createVNode)(x,null,{default:(0,a.withCtx)((()=>[r])),_:1}),(0,a.createVNode)(x,null,{default:(0,a.withCtx)((()=>[i])),_:1})])),_:1}),(0,a.createVNode)(E,null,{default:(0,a.withCtx)((()=>[(0,a.createVNode)(_,{gutter:20},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(v,{span:8},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",s,[(0,a.withDirectives)((0,a.createElementVNode)("input",{type:"search",class:"form-control",placeholder:"请输入内容","onUpdate:modelValue":t[0]||(t[0]=e=>N.queryInfo.query=e)},null,512),[[a.vModelText,N.queryInfo.query]]),(0,a.createElementVNode)("button",{class:"btn btn-outline-secondary",type:"button",id:"button-addon2",onClick:t[1]||(t[1]=e=>b.getUserList())},n)])])),_:1}),(0,a.createVNode)(v,{span:4},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("button",{type:"button",class:"btn btn-primary",onClick:t[2]||(t[2]=e=>N.addDialogVisible=!0)},"添加用户")])),_:1})])),_:1}),(0,a.createVNode)($,{data:N.userlist,border:"",stripe:""},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(k,{type:"index",label:"索引"}),(0,a.createVNode)(k,{label:"角色",prop:"role_name"}),(0,a.createVNode)(k,{label:"姓名",prop:"username"}),(0,a.createVNode)(k,{label:"电话",prop:"mobile"}),(0,a.createVNode)(k,{label:"邮箱",prop:"email"}),(0,a.createVNode)(k,{label:"状态"},{default:(0,a.withCtx)((e=>[(0,a.createVNode)(R,{modelValue:e.row.mg_state,"onUpdate:modelValue":t=>e.row.mg_state=t,onChange:t=>b.userStateChanged(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,a.createVNode)(k,{label:"操作"},{default:(0,a.withCtx)((e=>[(0,a.createVNode)(D,{type:"primary",size:"mini",icon:N.Edit,onClick:t=>b.showEditDialog(e.row.id)},null,8,["icon","onClick"]),(0,a.createVNode)(F,{effect:"dark",content:"分配角色",placement:"top",enterable:!1},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(D,{type:"warning",size:"mini",icon:N.Setting,onClick:t=>b.setRole(e.row)},null,8,["icon","onClick"])])),_:2},1024),(0,a.createVNode)(D,{type:"danger",size:"mini",icon:N.Delete,onClick:t=>b.removeUserById(e.row.id)},null,8,["icon","onClick"])])),_:1})])),_:1},8,["data"]),(0,a.createVNode)(B,{currentPage:N.queryInfo.pagenum,"onUpdate:currentPage":t[3]||(t[3]=e=>N.queryInfo.pagenum=e),"page-size":N.queryInfo.pagesize,"onUpdate:page-size":t[4]||(t[4]=e=>N.queryInfo.pagesize=e),"page-sizes":[1,2,5,10],small:e.small,disabled:e.disabled,background:e.background,layout:"total, sizes, prev, pager, next, jumper",total:N.total,onSizeChange:b.handleSizeChange,onCurrentChange:b.handleCurrentChange},null,8,["currentPage","page-size","small","disabled","background","total","onSizeChange","onCurrentChange"])])),_:1}),(0,a.createVNode)(T,{modelValue:N.addDialogVisible,"onUpdate:modelValue":t[10]||(t[10]=e=>N.addDialogVisible=e),title:"添加用户",width:"50%","before-close":e.handleClose,onClose:b.addDialogClosed},{footer:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",c,[(0,a.createVNode)(D,{onClick:t[9]||(t[9]=e=>N.addDialogVisible=!1)},{default:(0,a.withCtx)((()=>[u])),_:1}),(0,a.createVNode)(D,{type:"primary",onClick:b.addUser},{default:(0,a.withCtx)((()=>[m])),_:1},8,["onClick"])])])),default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{ref:"addFormRef",model:N.addForm,rules:N.addFormRules,"label-width":"70px",size:e.formSize},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(I,{label:"用户名",prop:"username"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(L,{modelValue:N.addForm.username,"onUpdate:modelValue":t[5]||(t[5]=e=>N.addForm.username=e)},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(I,{label:"密码",prop:"password"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(L,{modelValue:N.addForm.password,"onUpdate:modelValue":t[6]||(t[6]=e=>N.addForm.password=e)},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(I,{label:"邮箱",prop:"email"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(L,{modelValue:N.addForm.email,"onUpdate:modelValue":t[7]||(t[7]=e=>N.addForm.email=e)},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(I,{label:"手机",prop:"mobile"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(L,{modelValue:N.addForm.mobile,"onUpdate:modelValue":t[8]||(t[8]=e=>N.addForm.mobile=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules","size"])])),_:1},8,["modelValue","before-close","onClose"]),(0,a.createVNode)(T,{title:"修改用户",modelValue:N.editDialogVisible,"onUpdate:modelValue":t[15]||(t[15]=e=>N.editDialogVisible=e),width:"50%",onClose:b.editDialogClosed},{footer:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",h,[(0,a.createVNode)(D,{onClick:t[14]||(t[14]=e=>N.editDialogVisible=!1)},{default:(0,a.withCtx)((()=>[p])),_:1}),(0,a.createVNode)(D,{type:"primary",onClick:b.editUserInfo},{default:(0,a.withCtx)((()=>[g])),_:1},8,["onClick"])])])),default:(0,a.withCtx)((()=>[(0,a.createVNode)(U,{model:N.editForm,rules:N.editFormRules,ref:"editFormRef","label-width":"70px",onClose:b.editDialogClosed},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(I,{label:"用户名"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(L,{modelValue:N.editForm.username,"onUpdate:modelValue":t[11]||(t[11]=e=>N.editForm.username=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(I,{label:"邮箱",prop:"email"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(L,{modelValue:N.editForm.email,"onUpdate:modelValue":t[12]||(t[12]=e=>N.editForm.email=e)},null,8,["modelValue"])])),_:1}),(0,a.createVNode)(I,{label:"手机号",prop:"mobile"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(L,{modelValue:N.editForm.mobile,"onUpdate:modelValue":t[13]||(t[13]=e=>N.editForm.mobile=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules","onClose"])])),_:1},8,["modelValue","onClose"]),(0,a.createVNode)(T,{title:"分配角色",modelValue:N.SetRoleDialogVisible,"onUpdate:modelValue":t[18]||(t[18]=e=>N.SetRoleDialogVisible=e),onClose:b.setRolesDialogClosed,width:"50%"},{footer:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",f,[(0,a.createVNode)(D,{onClick:t[17]||(t[17]=e=>N.SetRoleDialogVisible=!1)},{default:(0,a.withCtx)((()=>[C])),_:1}),(0,a.createVNode)(D,{type:"primary",onClick:b.saveRolesInfo},{default:(0,a.withCtx)((()=>[w])),_:1},8,["onClick"])])])),default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("p",null,"当前的用户："+(0,a.toDisplayString)(N.userInfo.username),1),(0,a.createElementVNode)("p",null,"当前的角色："+(0,a.toDisplayString)(N.userInfo.role_name),1),(0,a.createElementVNode)("p",null,[V,(0,a.createVNode)(S,{modelValue:N.selectedRoleId,"onUpdate:modelValue":t[16]||(t[16]=e=>N.selectedRoleId=e),placeholder:"请选择"},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(N.rolesList,(e=>((0,a.openBlock)(),(0,a.createBlock)(z,{key:e.id,label:e.roleName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["modelValue","onClose"])],64)}o(1703);var b=o(547),x=o(4876),y=o(5092),v=o(8541),_={data(){const e=(e,t,o)=>{const a=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/;if(a.test(t))return o();o(new Error("请输入合法邮箱"))},t=(e,t,o)=>{const a=/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/;if(a.test(t))return o();o(new Error("请输入正确手机号"))};return{queryInfo:{query:"",pagenum:1,pagesize:5},userlist:[],total:0,Delete:b.Z,Edit:x.Z,Setting:y.Z,Search:v.Z,addDialogVisible:!1,editDialogVisible:!1,SetRoleDialogVisible:!1,userInfo:{},rolesList:[],selectedRoleId:"",addForm:{username:"",password:"",email:"",mobile:""},editForm:{},editFormRules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:t,trigger:"blur"}]},addFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"长度在3到10个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:10,message:"密码长6-10个间",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:t,trigger:"blur"}]}}},created(){this.getUserList()},methods:{async getUserList(){const{data:e}=await this.$http.get("users",{params:this.queryInfo});if(200!==e.meta.status)return this.$message.error("获取用户列表失败！");this.userlist=e.data.users,this.total=e.data.total},handleSizeChange(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange(e){this.queryInfo.pagenum=e,this.getUserList()},async userStateChanged(e){const{data:t}=await this.$http.put(`users/${e.id}/state/${e.mg_state}`);if(200!==t.meta.status)return e.mg_state=!e.mg_state,this.$message.error("更新用户状态失败");this.$message.success("用户状态更新成功")},addDialogClosed(){this.$refs.addFormRef.resetFields()},addUser(){this.$refs.addFormRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post("users",this.addForm);if(201!==t.meta.status)return this.$message.error("添加用户失败！");this.$message.success("添加用户成功"),this.addDialogVisible=!1,this.getUserList()}))},async showEditDialog(e){const{data:t}=await this.$http.get("users/"+e);if(200!==t.meta.status)return this.$message.error("查询用户信息失败");this.editForm=t.data,this.editDialogVisible=!0},editDialogClosed(){this.$refs.editFormRef.resetFields()},editUserInfo(){this.$refs.editFormRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.put("users/"+this.editForm.id,{email:this.editForm.email,mobile:this.editForm.mobile});if(200!==t.meta.status)return this.$message.error("修改用户信息失败！");this.$message.success("修改用户信息成功"),this.editDialogVisible=!1,this.getUserList()}))},async removeUserById(e){const t=await this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!=t)return this.$message.info("已取消删除");const{data:o}=await this.$http.delete("users/"+e);if(200!==o.meta.status)return this.$message.error("删除失败");this.$message.success("确认删除"),this.getUserList()},async setRole(e){this.userInfo=e;const{data:t}=await this.$http.get("roles");if(200!==t.meta.status)return this.$message.error("获取角色失败");this.rolesList=t.data,this.SetRoleDialogVisible=!0},async saveRolesInfo(){if(!this.selectRoleId)return this.$message.error("请选择要分配的角色!");const{data:e}=await this.$http.put(`users/${this.userInfo.id}/role`,{rid:this.selectedRoleId});if(200!==e.meta.status)return this.$message.error("更新角色失败!");this.$message.success("更新角色成功!"),this.getUserList(),this.setRolesDialogVisible=!1},setRolesDialogClosed(){this.selectRoleId="",this.userInfo=""}}},k=o(89);const R=(0,k.Z)(_,[["render",N]]);var D=R},4876:function(e,t,o){o.d(t,{Z:function(){return u}});var a=o(311),l=o(6854);const r=(0,a.defineComponent)({name:"Edit"}),i={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},s=(0,a.createElementVNode)("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z"},null,-1),d=(0,a.createElementVNode)("path",{fill:"currentColor",d:"m469.952 554.24 52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1),n=[s,d];function c(e,t,o,l,r,s){return(0,a.openBlock)(),(0,a.createElementBlock)("svg",i,n)}var u=(0,l.Z)(r,[["render",c]])},5092:function(e,t,o){o.d(t,{Z:function(){return c}});var a=o(311),l=o(6854);const r=(0,a.defineComponent)({name:"Setting"}),i={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},s=(0,a.createElementVNode)("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"},null,-1),d=[s];function n(e,t,o,l,r,s){return(0,a.openBlock)(),(0,a.createElementBlock)("svg",i,d)}var c=(0,l.Z)(r,[["render",n]])}}]);
//# sourceMappingURL=Users_Rights_Roles.b12a756d.js.map